

# LoL Esports Match Outcome Prediction

本项目旨在利用《英雄联盟》职业比赛数据，通过机器学习模型预测比赛的胜负结果。项目探索了多种特征工程方法和分类模型，并对模型性能进行了详细评估。

## 📁 项目目录结构

```text
.
├── Esports dataset
│   ├── my        # 数据和代码
│   ├── pic       # 图片或可视化结果
│   └── data      # 原始数据文件
├── player_winrate_over10.csv
├── position_stats_combined.csv
└── README.md
```

## 🚀 项目核心流程

项目的工作流程主要分为以下几个步骤，均在 `randomForest_XGB.ipynb` 文件中实现：

1.  **数据加载与合并**: 加载比赛对战数据、选手单排数据和全局英雄数据。
2.  **特征工程**: 基于原始数据，构建能够量化两队实力差距的关键特征。
3.  **模型训练**: 使用多种机器学习模型（随机森林、XGBoost、逻辑回归、SVM）进行训练。
4.  **模型评估**: 通过准确率、F1分数、混淆矩阵和10折交叉验证等多种方式评估模型性能。

## 📊 数据源

本项目使用了以下三类数据：

| 文件名 | 路径 | 描述 |
| :--- | :--- | :--- |
| `2021_worlds_kda_with_result.csv` | `./data/` | 2021年世界赛的详细比赛数据，包括队伍、选手和使用的英雄。 |
| `pro_player_champion_stats.xlsx` | `./data/` | 全局职业赛场上各英雄在不同位置的选用率、胜率等统计数据。 |
| `solo_stats.csv` | `./data/` | 职业选手在比赛期间的单排（Solo Queue）数据，包含特定英雄的胜率和使用场次。 |

## 🛠️ 特征工程

特征工程是本项目的核心。我们通过以下步骤构建了能够体现队伍间实力差异的特征：

1.  **数据匹配**:
    *   为每场比赛的每个选手匹配其 **全局英雄数据**（如，该英雄在职业赛场的通用胜率）。
    *   为每场比赛的每个选手匹配其 **个人单排数据**（如，该选手使用该英雄的单排胜率）。

2.  **队伍级别聚合**:
    *   将选手级别的特征（如全局胜率、单排胜率）按队伍进行聚合，计算出每支队伍的 **平均特征值**。

3.  **计算实力差值 (Difference Features)**:
    *   将同一场比赛的两支队伍数据合并，计算两队在各项平均特征上的 **差值**。这些差值是模型训练的最终输入特征，例如：
        *   `winrate_diff`: 两队全局英雄平均胜率的差值。
        *   `picks_diff`: 两队全局英雄平均选用次数的差值。
        *   `solo_winrate_diff`: 两队选手单排平均胜率的差值。

## 🤖 建模与分析

我们使用了四种不同的分类模型来预测比赛结果 (`A_win` 列，1代表A队胜利，0代表B队胜利)。

### 1. 随机森林 (Random Forest)
*   **特点**: 一种集成学习模型，鲁棒性强，不易过拟合。
*   **处理样本不平衡**: 通过设置 `class_weight='balanced'` 来自动调整权重，应对胜负样本不均的问题。

### 2. XGBoost
*   **特点**: 高效、灵活且性能强大的梯度提升框架。
*   **处理样本不平衡**: 通过计算并设置 `scale_pos_weight` 参数来平衡正负样本的权重。

### 3. 逻辑回归 (Logistic Regression)
*   **特点**: 经典的线性分类模型，模型简单，解释性强，可以作为优秀的基线模型。

### 4. 支持向量机 (Support Vector Machine, SVM)
*   **特点**: 在中小型数据集上表现优异，擅长处理复杂的非线性边界。
*   **数据标准化**: 由于SVM对特征尺度敏感，我们使用了 `StandardScaler` 将所有特征标准化（均值为0，方差为1），并通过 `Pipeline` 将其与模型训练过程无缝集成，以防止数据泄露。

## 📈 模型评估

为了全面评估模型性能，我们采用了以下方法：

*   **基础性能指标**: 使用 `accuracy_score` 和 `f1_score` 在测试集上进行快速评估。
*   **混淆矩阵**: 可视化模型在各个类别上的预测表现，直观地展示真阳性、假阳性、真阴性和假阴性的数量。
*   **10折交叉验证**: 为了获得更稳健和可靠的性能评估，我们对每个模型都进行了10折分层交叉验证 (`StratifiedKFold`)，并计算了准确率的平均值。

## ⚙️ 如何运行

1.  **安装依赖**:
    ```bash
    pip install pandas numpy scikit-learn xgboost matplotlib seaborn openpyxl
    ```

2.  **准备数据**:
    *   确保所有数据文件（`.csv`, `.xlsx`）都位于 `./data/` 目录下。
    *   确保 `champion_map_zh2en.py` 等辅助脚本与主 Notebook 文件位于同一目录。

3.  **运行 Notebook**:
    *   打开并按顺序执行 `DSAI5101/Esports dataset/my/randomForest_XGB.ipynb` 中的所有单元格。

## 💡 结论与思考

*   **特征的重要性**: 从随机森林和XGBoost的特征重要性分析可以看出，基于选手个人表现的特征（如 `solo_winrate_diff`）比基于英雄全局表现的特征（如 `winrate_diff`）对比赛结果的预测能力更强。
*   **数据时效性与概念漂移**: 实验发现，使用2021年的数据来预测2024年的比赛时，模型性能会急剧下降。这是因为游戏版本（英雄、装备、地图）和选手状态都在不断变化，导致旧数据的预测能力失效。为了获得准确的预测，**必须使用与预测目标时间相近的数据进行训练**。

---
